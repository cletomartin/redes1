

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Transport layer &#8212; Computer Networks I</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'transport';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Network layer" href="network.html" />
    <link rel="prev" title="Application layer" href="application.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="main.html">
  
  
  
  
  
  
    <p class="title logo__title">Computer Networks I</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="main.html">
                    Computer Networks I
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Network architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="application.html">Application layer</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Transport layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="network.html">Network layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-link.html">Data-link layer</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/transport.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Transport layer</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#services">Services</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#port-addressing-and-sockets">Port addressing and sockets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encapsulation-and-decapsulation">Encapsulation and decapsulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplexing-and-demultiplexing">Multiplexing and demultiplexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-control">Flow control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-control">Error control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#congestion-control">Congestion control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectionless-and-connection-oriented-protocols">Connectionless and connection-oriented protocols</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transport-layer-protocols-in-tcp-ip-suite">Transport-layer protocols in TCP/IP suite</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#udp">UDP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tcp">TCP</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-segment">The TCP segment</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-connection-establishment">The TCP connection establishment</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-data-transfer">The TCP data transfer</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-connection-termination">The TCP connection termination</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segment-loss">Segment loss</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reliable-protocols">Reliable protocols</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-protocol">Simple protocol</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stop-and-wait">Stop and wait</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#go-back-n">Go back N</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="transport-layer">
<h1>Transport layer<a class="headerlink" href="#transport-layer" title="Permalink to this heading">#</a></h1>
<p>This lesson describes in depth the transport layer and describes some protocols for reliable data transmission.
You can find the slides <a class="reference download internal" download="" href="_downloads/ff636a4051d34dee3bf1ed498d618481/transport.odp"><span class="xref download myst">here</span></a>.</p>
<p>The transport layer provides a way to communicate <em>processes</em> that are located in different places.
These means that two applications can send and receive messages as they were directly connected.
The transport layer uses the network layer to transmit information between hosts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to remark the difference between the transport and network layer: the network layer’s domain is the hosts whereas the transport layer’s domain is the processes (applications) that run on these hosts.</p>
</div>
<p>In this section we are going to study the services provided by the transport layer to the application layer.</p>
<section id="services">
<h2>Services<a class="headerlink" href="#services" title="Permalink to this heading">#</a></h2>
<p>In this section some general concepts and transport-layer services are described.
These services are provided to the application layer.</p>
<section id="port-addressing-and-sockets">
<h3>Port addressing and sockets<a class="headerlink" href="#port-addressing-and-sockets" title="Permalink to this heading">#</a></h3>
<p>As it has been already mentioned, the transport layer communicates processes running on hosts.
Because an application could send data to one or more applications on another host, some kind of process addressing would be required.
The transport layer uses <em>port numbers</em> for distinguish applications within a server.</p>
<p>Using the client-server paradigm:</p>
<ul class="simple">
<li><p>A server application uses a <em>fixed</em> port so all clients can contact to it.
It is usually said that <em>an application is listening on port X</em> to describe</p></li>
<li><p>A client application uses an <em>ephemeral</em> port: its existence only lasts while communication takes place and can be changed the next time.</p></li>
</ul>
<p>Although we have not get into the <a class="reference internal" href="network.html"><span class="doc std std-doc">network layer</span></a>, every hosts has its own network address (usually an IP address).
The port number is a <em>higher-level</em> address as it points to an application running on the host:</p>
<ul class="simple">
<li><p>The IP address selects the host.</p></li>
<li><p>The port number selects the application of the host.</p></li>
</ul>
<p>The combination of IP address + port number is known as <em>socket address</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is what we used in our example of socket programming: <code class="docutils literal notranslate"><span class="pre">s.connect((HOST,</span> <span class="pre">PORT))</span></code>.</p>
</div>
<p>The standard organisation ICANN has defined the following port ranges:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Range</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Well-known</p></td>
<td><p>0-1023</p></td>
<td><p>Controlled by IANA</p></td>
</tr>
<tr class="row-odd"><td><p>Registered</p></td>
<td><p>1024-49151</p></td>
<td><p>Registered by IANA but not controlled</p></td>
</tr>
<tr class="row-even"><td><p>Dynamic</p></td>
<td><p>49152-65535</p></td>
<td><p>Temporary and private ports</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Explore <code class="docutils literal notranslate"><span class="pre">/etc/services</span></code> and show the different applications associated with the port numbers.
Also mention that there can be 2 ports for a speific applications (TCP and UDP).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Explain the example of using <code class="docutils literal notranslate"><span class="pre">nc</span></code> for creating a local TCP server and listen on port 12345.
With <code class="docutils literal notranslate"><span class="pre">netstat</span></code> you can explore the processes that are currently listening:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-l</span></code>: shows only those processes in <code class="docutils literal notranslate"><span class="pre">LISTEN</span></code> status.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span></code>: shows the program names.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-t</span></code>: shows only TCP.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-n</span></code>: shows IPs instead of hostnames.</p></li>
</ul>
</div>
</section>
<section id="encapsulation-and-decapsulation">
<h3>Encapsulation and decapsulation<a class="headerlink" href="#encapsulation-and-decapsulation" title="Permalink to this heading">#</a></h3>
<p>As any intermediate layer, the transport layer receives messages from the application layer and from the network layer:</p>
<ul class="simple">
<li><p><em>Encapsulation</em>: application messages are transformed into <em>segments</em> or <em>datagrams</em> (depending on the transport protocol we use).
The application message (the <em>payload</em>) is appended with a <em>transport header</em> that describes its content and has useful information for the receiver to consume.
This process happens on the <em>sender</em> side.</p></li>
<li><p><em>Decapsulation</em>: the transport layer processes each segments or datagrams coming from the network layer.
It removes the transport header and passes the payload to the application network.
This process happens on the <em>receiver</em> side.</p></li>
</ul>
</section>
<section id="multiplexing-and-demultiplexing">
<h3>Multiplexing and demultiplexing<a class="headerlink" href="#multiplexing-and-demultiplexing" title="Permalink to this heading">#</a></h3>
<p>Multiple processes can be communicating all at the same time, exchanging information with different remote processes.
The transport layer needs to be able to perform the following operations in order to achieve this:</p>
<ul class="simple">
<li><p><em>Multiplexing</em>: <em>many</em> processes will use the transport layer as <em>one</em> logical channel.
This is performed at the sender side.</p></li>
<li><p><em>Demultiplexing</em>: the information that comes from the transport layer’s logical channel needs to be deliver to the right process.
This is performed at the receiver side.</p></li>
</ul>
</section>
<section id="flow-control">
<h3>Flow control<a class="headerlink" href="#flow-control" title="Permalink to this heading">#</a></h3>
<p>It is important to control the amount of data a sender can <em>produce</em> and a receiver can <em>consume</em>.
There needs to be a <em>balance</em> between them:</p>
<ul class="simple">
<li><p>If the sender produces too few data, the receiver might be idle.</p></li>
<li><p>If the sender produces too much data, the receiver can be overwhelmed.</p></li>
<li><p>Circumstances might change as communication progresses (e.g. the receiver might get slower because of it is busy with something else).</p></li>
</ul>
<p>In general, a process may deliver data in 2 ways:</p>
<ul class="simple">
<li><p><em>Pull</em>: the receiver <em>requests</em> for more data to the sender.
In this case, there is no need of flow control mechanism as the receiver can request data as needed.</p></li>
<li><p><em>Push</em>: the sender delivers the data <em>as it is produced</em>.
This mechanism requires some kind of control as the receiver can be overwhelmed or being idle.</p></li>
</ul>
<p>This pull and push model is used differently across the components of the transport layer:</p>
<ul class="simple">
<li><p><em>Between the sender application and the transport layer</em>: the application <em>pushes</em> data to the transport layer,
so there is a flow control mechanism between them.</p></li>
<li><p><em>Between the sender’s transport layer and the receiver’s transport layer</em>: when segments/datagrams are ready, the sender’s transport layer <em>pushes</em> them to the receiver’s one.
Another flow control mechanism is needed here too.</p></li>
<li><p><em>Between the receiver’s transport layer and the receiver application</em>: the receiver application <em>pulls</em> data from the its transport layer.
In this case, a flow control mechanism is not required as the application consumes data on-demand.</p></li>
</ul>
<p>The transport layer provides this flow control mechanism as we will see by the end of this chapter.</p>
</section>
<section id="error-control">
<h3>Error control<a class="headerlink" href="#error-control" title="Permalink to this heading">#</a></h3>
<p>The transport layer might work on top of an <em>unreliable network layer</em>. That’s the case, for example, for the TCP/IP stack.
For this reason, the transport layer provides a way to detect errors of the data transmitted.
Specifically, it has to deal with:</p>
<ol class="arabic simple">
<li><p><em>Corruption detection</em>:data might be modified during their trip across the network.
The transport layer provides a mechanism for detecting this type of data and discard them.</p></li>
<li><p><em>Loss detection</em>: data packets might be lost so the transport layer will provide a way to detect this loss and request for being resent.</p></li>
<li><p><em>Duplicate detection</em>: data packets might arrive duplicated for multiple reasons so the transport layer will discard any duplicated packet.</p></li>
<li><p><em>Out-of-order detection</em>: data packets might arrive in different order due to network conditions so the transport layer will detect it and re-order them properly.</p></li>
</ol>
<p>All these are achieved using these mechanisms:</p>
<ul class="simple">
<li><p><em>Checksums</em>: numerical values generated from the sent data. They can be used by the receiver for checking that the data haven’t been altered.</p></li>
<li><p><em>Sequence numbers</em>: packets are tagged with a increasing number so the order can be checked by the receiver.</p></li>
<li><p><em>Acknowledgement</em>: when packets are received, the receiver will have to acknowledge its arrival to the sender.
Thus, the sender knows which packets arrived and which ones did not.</p></li>
<li><p><em>Timers</em>: as the network is not reliable, sender and receiver will use different timers that will expire if data are not acknowledged on time or expected replies never arrive.</p></li>
</ul>
</section>
<section id="congestion-control">
<h3>Congestion control<a class="headerlink" href="#congestion-control" title="Permalink to this heading">#</a></h3>
<p>Congestion may happen on any system shared by different users that try to make use of it at the same time.
A congested network is a network where nodes <em>need to wait</em> for transmitting data.</p>
<p>The networking nodes (e.g. routers) use queues internally for dispatching packets to different routes.
These queues can be full if the networking nodes cannot consume packets at higher rate than they arrive.
The problem usually happens at network level and it manifests at transport layer too.</p>
</section>
<section id="connectionless-and-connection-oriented-protocols">
<h3>Connectionless and connection-oriented protocols<a class="headerlink" href="#connectionless-and-connection-oriented-protocols" title="Permalink to this heading">#</a></h3>
<p>Since the transport layer might work on different context and applications,
it is possible that not all features might be required because another layer is already providing them or they are not required for a particular context.
For these reason, the transport layer might be:</p>
<ul>
<li><p><em>Connectionless</em>: the data is sent in <em>atomic chunks</em>. These chunks, known as <em>datagrams</em>, do not have any kind of relationship between each other.
They are individual packets that the receiver will treat as separated units.
The datagrams are sent in order but the transport layer <em>will not</em> guarantee that the packets arrive in order to the application or prevent their loss.</p>
<p>This type of transport-layer protocols just provide a simple mechanism of sending packets from one application to another, without really providing extra services.
This is the case of UDP.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example, the packets arrive out of order and they are passed to the receiver’s application as they arrive, without any flwo or error control</p>
</div>
</li>
<li><p><em>Connection-oriented</em>: the data is sent through a <em>logical connection</em> between the sender and receiver.
The connection should be <em>established</em> before sending data and has to be <em>closed</em> afterwards.
The packets transported through a specific connection are related each other: they belong to the same context of communication.</p>
<p>This type of transport-layer protocols provide a more sophisticated set of services and can be used over unreliable layers like the network layer as
flow and error controls are implemented.
This is the case of TCP.</p>
</li>
</ul>
</section>
</section>
<section id="transport-layer-protocols-in-tcp-ip-suite">
<h2>Transport-layer protocols in TCP/IP suite<a class="headerlink" href="#transport-layer-protocols-in-tcp-ip-suite" title="Permalink to this heading">#</a></h2>
<p>TCP/IP protocol stack defines 3 transport protocols that can be used:</p>
<ul class="simple">
<li><p>UDP: User Datagram Procotol (connectionless)</p></li>
<li><p>TCP: Transmission Control Protocol (connection-oriented)</p></li>
<li><p>SCTP: Stream Control Transmission Protocol (connection-oriented that supports multiple redundant paths).</p></li>
</ul>
<p>We are going to focus on UDP and TCP. SCTP offers more complex services than TCP and it is used only in few context.</p>
<section id="udp">
<h3>UDP<a class="headerlink" href="#udp" title="Permalink to this heading">#</a></h3>
<p>The User Datagram Protocol (UDP) is the <em>connectionless</em> transport protocol included in the TCP/IP protocol suite.
It should be consider <em>unreliable</em> so it is up to the application layer to provide reliability if it is required.
This protocol is useful when a minimal overhead is required (e.g. real-time applications) and reliability/control is not strongly required (e.g. video/audio transmission).</p>
<p>UDP uses <em>user datagrams</em> (or just <em>datagrams</em>) as packets.
It has a fixed header of 8 bytes:</p>
<ul class="simple">
<li><p>2 bytes for the <em>source port</em>.</p></li>
<li><p>2 bytes for the <em>destination port</em>.</p></li>
<li><p>2 bytes for the <em>total length</em> of the data.
This means that a datagram can carry up-to 64KB (<span class="math notranslate nohighlight">\(2^{16}\)</span> bytes).</p></li>
<li><p>2 bytes for an <em>optional checksum</em>:</p>
<ul>
<li><p>If checksum is not desired, then it will be filled with 0s.</p></li>
<li><p>Checksum is calculated by adding all together in chunks of 16-bits the following:</p>
<ol class="arabic simple">
<li><p>A <em>pseudo-header</em> of source IP, destination IP, protocol type and UDP length.</p></li>
<li><p>The UDP header.</p></li>
<li><p>The UDP data.</p></li>
</ol>
</li>
</ul>
</li>
</ul>
<p>In essence, UDP provides no more than process-to-process communication on top of of the network layer:</p>
<ul class="simple">
<li><p>It is connectionless.</p></li>
<li><p>No flow control.</p></li>
<li><p>No error control although the optional checksum might be used by the application layer.</p></li>
<li><p>No congestion control.</p></li>
</ul>
<p>When an application requires a UDP port, the operating system creates 2 queues: <em>incoming</em> and <em>outgoing</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Show some of the well-known UDP protocols.</p>
<p>In Debian, you can install <code class="docutils literal notranslate"><span class="pre">inetsim</span></code> which includes many fake servers for different UDP protocols:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">inetsim</span>
</pre></div>
</div>
<p>Make sure that the Echo UDP service is running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span>  <span class="n">inetsim</span> <span class="n">status</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">echo</span>
</pre></div>
</div>
<p>In one terminal, you can show the log of <code class="docutils literal notranslate"><span class="pre">inetsim</span></code> so people can see the actions taken by each server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">tail</span> <span class="o">-</span><span class="n">f</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">inetsim</span><span class="o">/</span><span class="n">service</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Then you can use the following to show it working:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nc -u 127.0.0.1 7
Hello!
Hello!
</pre></div>
</div>
<p>Another interesting example is Daytime.
Show <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc867">RFC867</a> at UDP datagram.
You can run the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nc -u 127.0.0.1 13
type whatever
Sat Dec 16 16:15:40 2023
</pre></div>
</div>
<p>Also show the <a class="reference download internal" download="" href="_downloads/2f856c193d33d32f768a5dd418dbd6b1/main.py"><span class="xref download myst">DNS example</span></a>.
Just run it with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python src/simple-dns/main.py
</pre></div>
</div>
</div>
</section>
<section id="tcp">
<h3>TCP<a class="headerlink" href="#tcp" title="Permalink to this heading">#</a></h3>
<p>The Transmission Control Protocol (TCP) is a <em>connection-oriented</em> protocol that provides a reliable packet transport to the application layer:</p>
<ul class="simple">
<li><p>It is based on a combination of <em>Go Back N</em> and _Selective-Repeat_algorithms.
Lost and corrupted packets are retransmitted.</p></li>
<li><p>It uses mandatory <em>checksums</em> for error control.</p></li>
<li><p>Use of control messages like ACKs for ensuring packets are received.</p></li>
</ul>
<p>TCP is a complex protocol where client <em>establishes a connection</em> before exchanging data with the server.
At the end of the communication, the connection is closed.</p>
<p>TCP can be described as a <em>Finate State Machine</em> (FSM).
The machine is really a program receiving/sending data and jumping between states.
The next state will depend on:</p>
<ul class="simple">
<li><p>The information received</p></li>
<li><p>The specific state where the machine is in.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Show the state diagram.
The machine starts in <code class="docutils literal notranslate"><span class="pre">LISTEN</span></code> state. In that state, if a <code class="docutils literal notranslate"><span class="pre">SYN</span></code> message is sent, the machine changes to <code class="docutils literal notranslate"><span class="pre">SYN_SENT</span></code> state.</p>
</div>
<p>TCP provides a <em>stream delivery service</em>.
This means that the information is transmitted as a stream of bytes from the client to the server.
From the client and server points of view, there is an imaginary pipe <em>connected</em> to both ends where bytes arrive in order to the other side.</p>
<p>TCP packets are called <em>segments</em> and the segments of a specific connection are related each other.
This means that the fields in the headers are logically connected to previous and following segments so they can be reassembled when received.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will see this more in depth in the following sections but it is worth mention the <em>circular buffers</em>.
This technique is used by TCP for providing reliability and flow control:</p>
<ul class="simple">
<li><p>On the sender side, they keep two types of segments:</p>
<ol class="arabic simple">
<li><p>The ones ready to be sent: these segments are built straighaway from the data coming from the application layer.</p></li>
<li><p>The ones already sent: when segments are already sent, the buffer can rotate and move on.</p></li>
</ol>
</li>
<li><p>On the receirver side, they keep two types of segments:</p>
<ol class="arabic simple">
<li><p>The ones just received but not read: those are waiting to be read by the applicatio.</p></li>
<li><p>The ones read by the application: when segments are read, the buffer can rotate and move on.</p></li>
</ol>
</li>
</ul>
</div>
<p>One of the important header fields are the <em>sequence number</em> and the <em>acknowledgement number</em>.
They both define the <em>numbering system</em> of TCP that allows:</p>
<ul class="simple">
<li><p>Reliability: as they provide confirmation of the reception.</p></li>
<li><p>Flow control: they define the amount of data the receiver is able to digest.</p></li>
</ul>
<p>TCP assigns numbers to the data. This <em>byte number</em> is:</p>
<ul>
<li><p>Different for each direction of the communication.</p></li>
<li><p>Initially generated randomly. It does not need to correlate to the data that is meant to be sent.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For example: we want to sent 6000 bytes of data.
If the first byte is numbered as 5432 (generated randomly) the last byte will be <span class="math notranslate nohighlight">\(5432 + 6000 - 1 = 11431\)</span></p>
</div>
</li>
</ul>
<p>TCP also assigns numbers to each segment. This is known as <em>sequence number</em> and it is generated as follows:</p>
<ul>
<li><p>The <em>initial sequence number</em> (ISN) for the first segment is generated randomly. It will be typically the first byte number (also generated randomly).</p></li>
<li><p>The following sequence number will be the previous segment’s sequence number plus the number of bytes carried by this previous segment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The example of the slide is the transmission of a file of 5000 bytes in 5 segments.
If the first byte was labeled as 10001, the:</p>
<ul class="simple">
<li><p>The first sequence segment will be 10001 and it will contain 1000 bytes.
The range of the byte numbers will be from 10001 to <span class="math notranslate nohighlight">\(10001 + 1000 - 1 = 11000\)</span></p></li>
</ul>
</div>
<p>TCP segments can carry data and/or control information. Sequence numbers are <em>only</em> use when data is carried.
For those segments that only carries control information, the meaning of their sequence number is different: they are not related with the data transmission.
As we will see later, for the future sequence numbers, these segments just consume 1 sequence number (as the carried 1 byte).</p>
</li>
</ul>
<p>On top of the sequence number, TCP header can also include an <em>acknowledgement number</em>.
The value of this number is the next byte number of the last one received.
In other words, <em>it is the number of the next byte expected</em>.
For example: if <code class="docutils literal notranslate"><span class="pre">ack</span> <span class="pre">=</span> <span class="pre">5643</span></code> it means that all bytes until <code class="docutils literal notranslate"><span class="pre">5642</span></code> has been recieved and we are waiting for the next one.
Of course, it does <em>not</em> mean the total bytes received are 5642 because the initial byte number is random and it is likely it was not 0.</p>
<section id="the-tcp-segment">
<h4>The TCP segment<a class="headerlink" href="#the-tcp-segment" title="Permalink to this heading">#</a></h4>
<p>A segment has two parts:</p>
<ul class="simple">
<li><p>A header that can be between 20-60 bytes.</p></li>
<li><p>The payload of the TCP segment.</p></li>
</ul>
<p>The TCP header has the following structure:</p>
<ul class="simple">
<li><p><em>Source port address</em></p></li>
<li><p><em>Destination port address</em></p></li>
<li><p><em>Sequence number</em>: if needed, it is the value of the first byte number carried by the segment.
Initially it takes a random ISN as value.</p></li>
<li><p><em>Acknowledgement number</em>: if needed, it is the value of the byte number expected.
The previous byte number has been received properly.</p></li>
<li><p><em>Header length</em>: measured in 4-byte words. This field is 4-bit long and since the header can be from 20 to 60 bytes, the values of this field might be from 5 to 15.</p></li>
<li><p><em>Control bits</em>: a 6-bit field where each bit categorise the segment:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">URG</span></code>: the segment carries urgent data so the urgent pointer field is valid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ACK</span></code>: the segment is an acknowledgement.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PSH</span></code>: the segment data should be pushed to the reciever application without waiting for buffers or windows.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RST</span></code>: the segment requires the connection to be reset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SYN</span></code>: the segment requests the synchronisation of sequence numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FIN</span></code>: the segment requests the termination of the connection.</p></li>
</ul>
</li>
<li><p><em>Window size</em>: gives the information to the sender of the the maximum amount of data that the receiver wants to receive.
Thus, the sender will have to respect this value.</p></li>
<li><p><em>Checksum</em>: it is mandatory in TCP and it is calculated very similarly to UDP’s one (it adds the pseudo-header on top of the TCP segment).</p></li>
<li><p><em>Urgent pointer</em>: if <code class="docutils literal notranslate"><span class="pre">URG</span></code> was set, this field points to the last byte of the urgent data within the segment.
The urgent data is placed at the beginning and this pointer helps to know when it ends.</p></li>
<li><p><em>Options and padding</em>: this optional field might incorporate extra data up to 40 bytes.</p></li>
</ul>
</section>
<section id="the-tcp-connection-establishment">
<h4>The TCP connection establishment<a class="headerlink" href="#the-tcp-connection-establishment" title="Permalink to this heading">#</a></h4>
<p>TCP is a connection-oriented protocol where a <em>bidirectional connection</em> is established between sender and reciever before any data is exchanged.
Once this connection is established, all segments will be logically related to this connection.</p>
<p>The TCP connection establishment is known as the <em>three-way handshaking</em> and it works like this (values come from the example of the slides):</p>
<ol class="arabic">
<li><p>The server starts to listen for incoming connections.
We say the server has a <em>passive</em> role during connection openings because it waits for the client to start them.</p></li>
<li><p>The client starts creation of a connection to the server.
We say the client has an <em>active</em> role during connection openings because it initiates them.</p>
<p>The first one is <code class="docutils literal notranslate"><span class="pre">SYN</span></code> segment which requires to the server to synchronise the sequence numbers.
The <em>ISN</em> in the example is 8000.</p>
</li>
<li><p>The server receives the <code class="docutils literal notranslate"><span class="pre">SYN</span></code>, so it sends a segment of 2 types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SYN</span></code>: requesting the client to synchronise the sequence number. The server’s ISN is 15000.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ACK</span></code>: acknowledging the previous client’s <code class="docutils literal notranslate"><span class="pre">SYN</span></code>. So the <code class="docutils literal notranslate"><span class="pre">ACK</span></code> number is 8001.</p></li>
</ul>
</li>
<li><p>The server recieves the <code class="docutils literal notranslate"><span class="pre">SYN-ACK</span></code> segment and responses with an <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment.
This segment acknowledges the <code class="docutils literal notranslate"><span class="pre">SYN</span></code> request in the previous message so:</p>
<ul class="simple">
<li><p>The sequence number is 8001 as it is the following one to 8000.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ACK</span></code> number is 15001 since we have recieved 15000 before.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The client could also send data along this <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment.
That way it can take advantage of this <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment and start sending data instead of doing it in a different segment.
This is known as <em>piggy-backing</em>.
If the client does <em>not</em> piggyback data within this segment, the sequence number will <em>not</em> be increased later.</p>
</div>
</li>
<li><p>The connection is now established.</p></li>
</ol>
<p>This connection establishment procedure has an intrinsic problem: the server has to acknowledge the initial <code class="docutils literal notranslate"><span class="pre">SYN</span></code> sent by the client.
A malicious actor can send lots of <code class="docutils literal notranslate"><span class="pre">SYN</span></code> segments with <em>spoofed</em> source IP.
This will make the server to send lots of <code class="docutils literal notranslate"><span class="pre">SYN-ACK</span></code> segments to clients that do not exist.
Since they do not exist, the server will never get a response so it will wait for the <code class="docutils literal notranslate"><span class="pre">ACK</span></code> untile the timeout expires.
If there are lots of <code class="docutils literal notranslate"><span class="pre">SYN</span></code> segments it is possible that the server waits for so many clients that it reaches its limit.
Thus, any <em>new and legit</em> <code class="docutils literal notranslate"><span class="pre">SYN</span></code> request will not be replied. This is a classic <em>Denial of Service</em> (DoS) attack.</p>
</section>
<section id="the-tcp-data-transfer">
<h4>The TCP data transfer<a class="headerlink" href="#the-tcp-data-transfer" title="Permalink to this heading">#</a></h4>
<p>Once the connection is established, then the bidirectional data exchange can happen:</p>
<ol class="arabic simple">
<li><p>The client sends 1000 bytes:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">SEQ</span></code> number is again 8001 because the previous <code class="docutils literal notranslate"><span class="pre">ACK</span></code> (the last segment of the connection establishment) did not contain data.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ACK</span></code> number is again 15001 because it is the expected byte number from the server.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">PSH</span></code> is on.</p></li>
<li><p>Note the byte numbers go from 8001 to 9000</p></li>
</ul>
</li>
<li><p>The client sends another 1000 bytes:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">SEQ</span></code> number is now 9001 (8001 + 1000).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ACK</span></code> is still 15001</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">PSH</span></code> is on.</p></li>
<li><p>The byte numbers go from 9001 to 10000</p></li>
</ul>
</li>
<li><p>The server has recieved both segments and it replies with an <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment piggybacked with data:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">SEQ</span></code> number is 15001.
It is still the same sequence number as the server has not sent data until now.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ACK</span></code> number is 10001, meaning that both chunks of 1000 bytes have been received.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">rwnd</span></code> is set to 3000, telling the client not to send more than 3000 bytes in a segment.</p></li>
<li><p>2000 bytes of data, so the byte numbers will go from 15001 to 17000.</p></li>
</ul>
</li>
<li><p>The client recieves the segment and creates another <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment, this time with no data:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">SEQ</span></code> number is 10001, as it comes after 1000 bytes previously sent.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ACK</span></code> is 17001, telling the server that it has recieved the last 2000 bytes.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">rwnd</span></code> is set to 10000, telling the server not to send more than 10000 bytes in a segment.</p></li>
</ul>
</li>
</ol>
</section>
<section id="the-tcp-connection-termination">
<h4>The TCP connection termination<a class="headerlink" href="#the-tcp-connection-termination" title="Permalink to this heading">#</a></h4>
<p>After the data is exchanged, the connection can be terminated at any time.
The closure can be done in 2 ways:</p>
<ul class="simple">
<li><p><em>Three-way handshaking</em>: this will fully terminate the connection.</p></li>
<li><p><em>Half-close</em>: this will allow the server to send data to the client before closing the connection.</p></li>
</ul>
<p>The three-way handshaking connection termination is as follows:</p>
<ol class="arabic">
<li><p>The client sends a <code class="docutils literal notranslate"><span class="pre">FIN</span></code> segment. The <code class="docutils literal notranslate"><span class="pre">SEQ</span></code> and <code class="docutils literal notranslate"><span class="pre">ACK</span></code> number values would depend on the previous conversation, so let’s suppose <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This <code class="docutils literal notranslate"><span class="pre">FIN</span></code> segment may also piggyback data, in which case it will affect the following sequence numbers.</p>
</div>
</li>
<li><p>The server sends a <code class="docutils literal notranslate"><span class="pre">FIN-ACK</span></code> segment, acknowledging the previous <code class="docutils literal notranslate"><span class="pre">FIN</span></code> request.</p></li>
<li><p>Finally, the client sends an <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment previous server’s <code class="docutils literal notranslate"><span class="pre">FIN</span></code> segment.</p></li>
</ol>
<p>The half-close connection termination is as follows:</p>
<ol class="arabic simple">
<li><p>The client sends the <code class="docutils literal notranslate"><span class="pre">FIN</span></code> segment.</p></li>
<li><p>The server sends an <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment this time, meaning that the <code class="docutils literal notranslate"><span class="pre">FIN</span></code> has been recieved..
However, the server still can send data to the client as a <code class="docutils literal notranslate"><span class="pre">FIN</span></code> was not sent.
All the recieved data in this time period will be acknowledged by the client.</p></li>
<li><p>When the server finishes the sending data, its <code class="docutils literal notranslate"><span class="pre">SEQ</span></code> number would be <code class="docutils literal notranslate"><span class="pre">z</span></code>, so a <code class="docutils literal notranslate"><span class="pre">FIN</span></code> is sent to the client with this sequence number.</p></li>
<li><p>Finally, the client sends an <code class="docutils literal notranslate"><span class="pre">ACK</span></code> segment for <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p></li>
</ol>
</section>
</section>
<section id="segment-loss">
<h3>Segment loss<a class="headerlink" href="#segment-loss" title="Permalink to this heading">#</a></h3>
<p>In a normal operation, <code class="docutils literal notranslate"><span class="pre">ACK</span></code> numbers are always recieved in order.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example, a client and a server exchange data:</p>
<ul class="simple">
<li><p>200 bytes to the server</p></li>
<li><p>1000 bytes to the client</p></li>
<li><p>Client acknowledges.</p></li>
<li><p>Server sends 2 segments of 1000 bytes each.</p></li>
<li><p>Client acknowledges both.</p></li>
</ul>
</div>
<p>However, some segments might get lost. This is detected because client and server keep a set timers and, if the expire, segments are retransmitted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example, a client and a server exchange data:</p>
<ul class="simple">
<li><p>The client sends 2 segments of 100 bytes each.</p></li>
<li><p>The server acknowledges both.</p></li>
<li><p>The client sends another 2 segments of 100 bytes each but the first one is lost.</p></li>
<li><p>The server sends <code class="docutils literal notranslate"><span class="pre">701</span></code> as <code class="docutils literal notranslate"><span class="pre">ACK</span></code> number because, even though it has recieved the second chunk, the first one was not.</p></li>
<li><p>The client’s timer expired for the chunk 701, so the segment is re-sent.</p></li>
<li><p>The server now recieves it so it can now acknowledge both (701 and 901).</p></li>
</ul>
</div>
</section>
</section>
<section id="reliable-protocols">
<h2>Reliable protocols<a class="headerlink" href="#reliable-protocols" title="Permalink to this heading">#</a></h2>
<section id="simple-protocol">
<h3>Simple protocol<a class="headerlink" href="#simple-protocol" title="Permalink to this heading">#</a></h3>
</section>
<section id="stop-and-wait">
<h3>Stop and wait<a class="headerlink" href="#stop-and-wait" title="Permalink to this heading">#</a></h3>
</section>
<section id="go-back-n">
<h3>Go back N<a class="headerlink" href="#go-back-n" title="Permalink to this heading">#</a></h3>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>TBD</p>
</div></blockquote>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="application.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Application layer</p>
      </div>
    </a>
    <a class="right-next"
       href="network.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Network layer</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#services">Services</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#port-addressing-and-sockets">Port addressing and sockets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encapsulation-and-decapsulation">Encapsulation and decapsulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplexing-and-demultiplexing">Multiplexing and demultiplexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-control">Flow control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-control">Error control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#congestion-control">Congestion control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectionless-and-connection-oriented-protocols">Connectionless and connection-oriented protocols</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transport-layer-protocols-in-tcp-ip-suite">Transport-layer protocols in TCP/IP suite</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#udp">UDP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tcp">TCP</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-segment">The TCP segment</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-connection-establishment">The TCP connection establishment</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-data-transfer">The TCP data transfer</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-tcp-connection-termination">The TCP connection termination</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segment-loss">Segment loss</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reliable-protocols">Reliable protocols</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-protocol">Simple protocol</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stop-and-wait">Stop and wait</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#go-back-n">Go back N</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Cleto Martín
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>